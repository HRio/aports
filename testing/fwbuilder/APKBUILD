# Contributor: Henrik Riomar <henrik.riomar@gmail.com>
# Maintainer:
pkgname=fwbuilder
pkgver=5.3.7
pkgrel=0
pkgdesc="GUI firewall management application"
url="https://github.com/fwbuilder/fwbuilder"
arch="all"
license="GPL-2.0-or-later"
checkdepends="cppunit-dev"
makedepends="automake autoconf libtool libxml2-dev libxslt-dev net-snmp-dev qt5-qtbase-dev qt5-qttools-dev"
source="${pkgname}-${pkgver}.tar.gz::https://github.com/$pkgname/$pkgname/archive/v${pkgver}.tar.gz
	fix-qt5-compile-error.patch
	Detect-qmake-qt5-automatically.patch
	unit_tests-fix-qt5-compile-error.patch
	"
builddir="$srcdir/$pkgname-$pkgver"

prepare() {
	default_prepare
	cd "$builddir"
	./autogen.sh --prefix=/usr
}

build() {
	cd "$builddir"
	make
}

check() {
	cd "$builddir"
	export PATH="$PATH:/usr/lib/qt5/bin"
	make tests
}

package() {
	cd "$builddir"
	make INSTALL_ROOT="$pkgdir" install
}

sha512sums="d6504ddab17e80cb332f005b6bbb16c15a7b4735361733f0e0437cb94059a5c9039e563be6e0e8d328954db2416b2c0bdbb8afa36cd946f61e7c7edaee47453b  fwbuilder-5.3.7.tar.gz
c28f4447428045203675fc51b3427a998feb2748c58fef3fa8216ccb847966a964ec30afd97d95fca0362c2fbcbee6e8f227e625fda495e64238b23011fb4865  fix-qt5-compile-error.patch
2ffba6932840199de80c566d79d2ef08ab72a1db600caa4342f7a76534622b1b2dae60c8127147fce500951759c4cf76bfa775909556549f43b6edc39fdaf77b  Detect-qmake-qt5-automatically.patch
1f391908d61b2da486a6f5ad9215c3f94d598a91ee9c4b2e679167724f527365921737ca50551bd8d95ba7d0a9ecb43e7b1c5e80780fab13adf582d3a4fe111b  unit_tests-fix-qt5-compile-error.patch"
